@using Microsoft.AspNetCore.Mvc.TagHelpers
@model AspNetArticle.MvcApp.Models.ArticlesCategoryViewModel

@{
    Layout = "_Layout";
}

@{
    ViewData["Title"] = "Article Page";
}

@if (User.Identity.IsAuthenticated && Model.Articles.Any())
{
    <div class="d-flex justify-content-end m-4 p-3 ">
        <form asp-controller="Article" asp-action="Index" method="post" class="d-flex me-3 ms-5">

            <select class="me-2 rounded-1" id="show-categories" asp-for="ArticleCategory" asp-items="Model.Categories">
                <option value="">Все</option>
            </select>

            <input asp-for="SearchString" class="form-control form-control-sm me-2" type="search" placeholder="Поиск новостей" aria-label="Search">
            <button class="btn btn-outline-success btn-sm" type="submit">Поиск</button>

        </form>
    </div>
}

@if(Model.Articles.Any()){

    <div class="container mt-5 d-md-flex flex-wrap h-100">
        
        @foreach (var art in Model.Articles.OrderByDescending(art => art.Rate))
        {
            <div class="col-6">
                <div class="row">
                    <div class="d-block pt-3 px-3 pt-md-5 px-md-5 pb-3 text-center col"
                         style="border: 1px solid #708090; border-radius: 5px; height: 600px; max-width: 550px; background-color: aliceblue;">

                        @if (User.Identity.IsAuthenticated)
                        {
                            //todo Add Article to Favorite 
                        }
                        <div class="d-flex justify-content-end">
                            <strong class="bg-warning mb-2 p-1 rounded">Рейтинг: @string.Format("{0:0.00}", art.Rate)</strong>
                        </div>

                        <h5>@art.Title</h5>

                        <div class="mb-3">
                            <img src="@art.ImageUrl"/>
                        </div>
                        <div>
                            @art.ShortDescription
                        </div>
                        
                        <div class="align-bottom">
                            <a class="btn btn-primary btn-sm col w-50" asp-controller="Article" asp-action="Details" asp-route-id="@art.Id">Читать далее...</a>
                        </div>

                    </div>
                </div>
            </div>
        }
    </div>
}
else{
    <h2>На данный момент новостей нет</h2>
}